# GEO-metadata
A tool to organize the extracted GEO-Metadata into a dataframe

- Using the XML webscraper-parser output files, this tool will organize all the metadata extracted in a dataframe. Furthermore, additional columns will be added to help the analysis.

# Requiremets

```python 3.8``` and ```create a env with requirements.txt```

# Usage main.py

This script receives the output files from XML webscraper-parser to organize the metadata information into a dataframe. Also, it receives a dictionary of regex (core IHEC Histones - h3k4me3, h3k4me1, h3k27me3, h3k27ac, h3k9me3, h3k36me3 + inputs) to create new columns based on matches associated to ChIP-antibody-catalog, Target, GSM_title and Source columns. For each match, a confidence level (CL) will be recorded. Please check the description below:

- Additional columns by matching dict of regex:

  - **Target-interest**: receives the metadata info when we have a match from one of these `ChIP-antibody-catalog`, `Target`, `GSM_title` and `Source` columns. If a simultaneous match occurs for `Target and ChIP-antibody-catalog`, both information will be stored using **':::'** as separator. 
  - **Target-target** and **Target-catalog**: receive the metadata information if a simultaneous match occurs for `Target and ChIP-antibody-catalog`. The `Target-target` columns receives the information from `Target` column, and `Target-catalog` receives the metadata from `ChIP-antibody-catalog`.
  - **CL-target** (confidence-level): Depending on the column where the script finds the match, the confidence level will be as follow:
    - First: match on `Target` and `ChIP-antibody-catalog` simultaneously
    - Second: match on `ChIP-antibody-catalog`
    - Third: match on `Target`
    - Fourh: match on `GSM_title`
    - Fifth: match on `Source`
  - **Address**: SRX url for each GSM
  - **SRX**: SRX for each GSM
  - **SRR**: SRR for each GSM
  - **SRR_count**: number of SRR per GSM   


```
usage: main.py [-h] -f FILE -s SRR -d DICT [-w]

A script to organize the GEO metadata scrapped by XML_scraper tool, including SRX, SRR, SRR_Count, GPL and GSE titles.

optional arguments:
  -h, --help            show this help message and exit
  -f FILE, --file FILE  The absolute path to the csv file with the metadata information obtained via XML webscraper script
  -s SRR, --srr SRR     The absolute path to the csv file with the metadata SRX address, SRX and SRR information obtained via SRX/SRR
                        XML wevscrapp script
  -d DICT, --dict DICT  The absolute path to the csv file containig the target regex.
  -w, --webscraper
  ```

# Standardized target column

This script adds a new column `Target-GEO` containig a clean metadata information (dict regex key) to the dataframe generated by the script above.


```usage: main_stand.py [-h] -f FILE -d DICT -o OUTPUT

A script to generate a standardized Target column from the GEO-Metadata csv file.

optional arguments:
  -h, --help            show this help message and exit
  -f FILE, --file FILE  The absolute path to the csv file with the metadata information obtained via GEO-Metadata tool
  -d DICT, --dict DICT  The absolute path to the csv file with the target regexs
  -o OUTPUT, --output OUTPUT
                        The absolute path to save the final GEO dataframe including the Target-GEO column
```

To run these scripts via slurm, please check `sh_files` folder.